Makefile.connectal.build
========================

The target Makefile, which generated by makefilegen.py (which is invoked by Makefile.connectal), includes Makefile.connectal.build.

Make targets
------------

.. make:target:: bits

   Builds the FPGA bitstream.

.. make:target:: exe

   Builds the application software (executable or shared library).

.. make:target:: run

   Programs the FPGA and Runs the application.

Board-specific targets
----------------------

.. make:target:: ubuntu.exe

   Builds the application for boards using Ubuntu/Debian/CentOS Linux. Also used with xsim.

.. make:target:: android.exe

   Builds the application for boards using Android (e.g., zedboard).

.. make:target:: bsim_exe

   Builds the application for use with bluesim

.. make:target:: bsim

   Builds the hardware for Bluespec bluesim simulator

.. make:target:: xsim

   Builds the hardware for Xilinx xsim simulator


Environment Variables
---------------------

.. envvar:: RUNPARAM

   Specifies the name or address of the host on which to run the application.

.. envvar:: NOFPGAJTAG

   (Deprecated, use :envvar::`NOPROGRAM`. See also See also :c:data:`noprogram`.)
   If NOFPGAJTAG is defined, then fpgajtag is not called by ubuntu.exe
   or android.exe.

.. envvar:: NOPROGRAM

   If NOPROGRAM is defined, then the FPGA is not automatically
   programmed by ubuntu.exe or android.exe. See also
   :c:data:`noprogram`.


Variables Controlling the Build
-------------------------------

.. make:var:: V

   Binding V=1 makes the build verbose, displaying the commands that are run while building the project.

.. make:var:: CONNECTAL_SHARED

   Bind to 1 to build a shared library instead of an executable application.

.. make:var:: CONNECTAL_NOHARDWARE

   Binding to 1 suppresses creation of FPGA bitstream.

.. make:var:: CONNECTAL_NDK_PARAM

   Specifies options to pass to ndk-build.


Variables Controlling the Bluespec Compiler
-------------------------------------------

.. make:var:: BSCOPTFLAGS

   Specifies bsc optimization flags.

.. make:var:: BSCPATHFLAGS

   Specifies directories used to store output files from Bluespec compilation.

.. make:var:: BSCFLAGS_COMMON

   Specifies Connectal-specific bsc flags.

.. make:var:: BSCFLAGS_PROJECT

   Specifies project-specific bsc flags, -p argument passed to makefilegen.py via CONNECTALFLAGS.

.. make:var:: BSCFLAGS_EXTRA

   Specifies additional flags to pass to bsc.

Verilator-related Variables
-------------------------

.. make:var:: VERILATOR_PROJECT_ARGS

   Flags passed to verilator when compiling verilog for
   simulation. For example, to enable saving signal traces to a VCD
   file, add the following to your project's Makefile::

    CONNECTALFLAGS += -DVERILATOR_PROJECT_ARGS="--trace"


Bluesim-related Variables
-------------------------

.. make:var:: BSC_CXXFLAGS

   CXXFLAGS passed to C++ compiler when building application for bluesim target

Vivado-related Variables
------------------------

.. make:var:: VIVADOFLAGS

   Specifies options to pass when running vivado.

Buildcache related Variables
----------------------------

.. make:var:: USE_BUILDCACHE

   Bind to 1 to use buildcache.



Variables Controlling the Application
-------------------------------------

.. make:var:: CONNECTAL_DEBUG

   Bind CONNECTAL_DEBUG=1 to run the application under gdb.

.. make:var:: RUN_ARGS

   Specifies arguments to pass to the application when invoking it.

